(this["webpackJsonpbookshelf-app"]=this["webpackJsonpbookshelf-app"]||[]).push([[0],{13:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a(1),r=a.n(s),c=a(24),i=a.n(c),o=a(8),l=a(11),h=a.n(l),d=a(14),u=a(15),j=a(16),b=a(9),p=a(19),O=a(18),x=a(2);a(13);var f=function(e){var t=e.tags.map((function(e){return Object(n.jsx)("div",{children:e})}));return Object(n.jsxs)("div",{className:"book",children:[Object(n.jsx)("div",{className:"book-title",children:Object(n.jsx)("a",{className:"book-url",href:e.url,target:"_blank",children:e.title})}),Object(n.jsx)("div",{className:"book-tags",children:t})]})};var m=function(e){var t=e.query,a=e.submitQuery,s=e.books.map((function(e){return Object(n.jsx)("div",{className:"bookshelf",children:Object(n.jsx)("li",{children:Object(n.jsx)(f,{title:e.title,url:e.url,tags:e.tags})})})}));return Object(n.jsxs)("div",{className:"bookshelf",children:[Object(n.jsx)("h1",{children:"Bookshelf"}),Object(n.jsx)("div",{className:"search-bar-container",children:Object(n.jsx)("input",{type:"text",id:"search-bar",placeholder:"book name, author, or any #tag! (Temp: #tag search only !)",onChange:function(e){return a(e)},value:t})}),Object(n.jsx)("div",{className:"search-results",children:Object(n.jsx)("ol",{children:s})}),Object(n.jsx)("div",{className:"open-add-book",children:Object(n.jsx)(o.b,{to:"/addBook",children:Object(n.jsx)("button",{children:"Add a book"})})})]})},v=a(17),k=a(7),g="https://bookshelf.alchemist-hk.com/api",y=localStorage.token;y||(y=localStorage.token=Math.random().toString(36).substr(-8));var N={Accept:"application/json",Authorization:y},C=function(e){return fetch("".concat(g,"/book"),{method:"POST",headers:Object(k.a)(Object(k.a)({},N),{},{"Content-Type":"application/json"}),body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return e.books}))},S=function(e){Object(p.a)(a,e);var t=Object(O.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={title:"",url:"",tags:[],description:""},n.handleChange=n.handleChange.bind(Object(b.a)(n)),n.handleAddBook=n.handleAddBook.bind(Object(b.a)(n)),n}return Object(j.a)(a,[{key:"handleAddBook",value:function(){var e=Object(d.a)(h.a.mark((function e(t){var a,n,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=this.state.tags.trim().split(/\s+/).filter((function(e){return e})),n=a.map((function(e){return"#"===e.charAt(0)?e:"#".concat(e)})),s={title:this.state.title.trim(),tags:n,url:this.state.url.trim(),description:this.state.description.trim()},e.next=6,r=[s],fetch("".concat(g,"/book/bulk"),{method:"POST",headers:Object(k.a)(Object(k.a)({},N),{},{"Content-Type":"application/json"}),body:JSON.stringify(r)}).then((function(e){return e.json()}));case 6:e.sent,this.setState({title:"",url:"",tags:"",description:""});case 8:case"end":return e.stop()}var r}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(e){var t=e.target.name,a=e.target.value;this.setState(Object(v.a)({},t,a))}},{key:"render",value:function(){return Object(n.jsxs)("div",{className:"add-book-container",children:[Object(n.jsx)("h1",{children:"Add a new book"}),Object(n.jsxs)("form",{onSubmit:this.handleAddBook,children:[Object(n.jsxs)("span",{children:[Object(n.jsx)("div",{className:"label",children:"Title"}),Object(n.jsx)("div",{className:"input",children:Object(n.jsx)("input",{name:"title",type:"text",id:"title",placeholder:"e.g Attention is all your need",onChange:this.handleChange,value:this.state.title,required:!0})})]}),Object(n.jsxs)("span",{children:[Object(n.jsx)("div",{className:"url",children:"URL"}),Object(n.jsx)("div",{className:"input",children:Object(n.jsx)("input",{name:"url",type:"url",id:"url",placeholder:"e.g https://arxiv.org/pdf/1706.03762.pdf",onChange:this.handleChange,value:this.state.url,required:!0})})]}),Object(n.jsxs)("span",{children:[Object(n.jsx)("div",{className:"tags",children:"Tags"}),Object(n.jsx)("div",{className:"input",children:Object(n.jsx)("input",{name:"tags",type:"text",id:"tags",placeholder:"#Transformer #Attention",onChange:this.handleChange,value:this.state.tags,required:!0})})]}),Object(n.jsxs)("span",{children:[Object(n.jsx)("div",{className:"description",children:"Description"}),Object(n.jsx)("div",{className:"input",children:Object(n.jsx)("input",{name:"description",type:"text",id:"description",placeholder:"e.g This is for your attention~",onChange:this.handleChange,value:this.state.description,required:!0})})]}),Object(n.jsx)("span",{children:Object(n.jsx)("div",{className:"add-button",children:Object(n.jsx)("button",{type:"submit",children:"Add"})})})]}),Object(n.jsx)("div",{className:"open-search",children:Object(n.jsx)(o.b,{to:"/",children:"back to search"})})]})}}]),a}(r.a.Component),A=function(e){Object(p.a)(a,e);var t=Object(O.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).handleSearch=n.handleSearch.bind(Object(b.a)(n)),n.state={books:[],searchValue:""},n}return Object(j.a)(a,[{key:"handleSearch",value:function(){var e=Object(d.a)(h.a.mark((function e(t){var a,n,s,r,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.value,this.setState({searchValue:a}),n={tags:[]},this.state.searchValue.includes("#")&&(s=this.state.searchValue.split(/\s+/).filter((function(e){return e})),r=s.map((function(e){return"#"===e.charAt(0)?e:"#".concat(e)})),n.tags=r),console.log(n),e.next=7,C(n);case 7:c=e.sent,this.setState((function(e){return{books:c}}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.books,s=t.searchValue;return Object(n.jsx)("div",{className:"app",children:Object(n.jsx)(o.a,{basename:"/bookshelf-app",children:Object(n.jsxs)(x.c,{children:[Object(n.jsx)(x.a,{exact:!0,path:"/",render:function(t){t.history;return Object(n.jsx)(m,{query:s,submitQuery:e.handleSearch,books:a})}}),Object(n.jsx)(x.a,{exact:!0,path:"/addBook",render:function(e){e.history;return Object(n.jsx)(S,{})}})]})})})}}]),a}(r.a.Component);i.a.render(Object(n.jsx)(o.a,{children:Object(n.jsx)(A,{})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.689fcccc.chunk.js.map